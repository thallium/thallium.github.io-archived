---
published: true
title: AtCoder Beginner Contest 160E - Distributing Integers
category: 题解/Tutorial
tags: 
- 动态规划/DP
- 树上DP/Tree DP
- 数学
- 组合学/Combinatorics
- DFS
layout: post
---
做出这题的一瞬间我整个人都舒服了。
<!-- more -->

## Solution

[Similar Problem]({% post_url 2020-03-30-CF1187E %})

## Code

{% highlight cpp %}
#include <bits/stdc++.h>

#define forn(i, n) for (int i = 0; i < int(n); ++i)
#define for1(i, n) for (int i = 1; i <= int(n); ++i)
#define fore(i, l, r) for (int i = int(l); i <= int(r); ++i)
#define ford(i, n) for (int i = int(n)-1; i >= 0; --i)
#define pb push_back
#define eb emplace_back
#define ms(a, x) memset(a, x, sizeof(a))
#define F first
#define S second
#define endl '\n'
#define all(x) (x).begin(),(x).end()

using namespace std;
typedef long long ll;
typedef pair<int, int> pii;
const int INF = 0x3f3f3f3f;
mt19937 gen(chrono::high_resolution_clock::now().time_since_epoch().count());
//template<typename... Args>
//void write(Args... args) { ((cout << args << " "), ...); cout<<endl;}

const int N=2e5+5;
vector<int> G[N];
const int mod=1e9+7;
ll ans[N];
ll fac[N],inv[N];
ll binpow(ll a,int b){
   ll res=1;
   for(;b;b>>=1){
       if(b&1) res=res*a%mod;
       a=a*a%mod;
   }
   return res;
}
ll dp[N],sz[N];
int n;
void cal(int u,int f){
    sz[u]=1;
    int res=1;
    for(auto to:G[u]){
        if(to!=f){
            cal(to,u);
            sz[u]+=sz[to];
            res=res*dp[to]%mod*inv[sz[to]]%mod;
        }
    }
    res=res*fac[sz[u]-1]%mod;
    dp[u]=res;
}
void dfs(int u,int f,int par){
    ans[u]=par;
    for(auto to:G[u]) if(to!=f){
        dfs(to,u,par*sz[to]%mod*binpow(n-sz[to],mod-2)%mod);
    }
}
int main() {
    ios::sync_with_stdio(false);
    cin.tie(nullptr);
    cin>>n;
    fac[0]=1;
    for(int i=1;i<=n;i++) fac[i]=fac[i-1]*i%mod;
    inv[n]=binpow(fac[n],mod-2);
    for(int i=n-1;i>=0;i--) inv[i]=inv[i+1]*(i+1)%mod;
    forn(i,n-1){
        int x,y;
        cin>>x>>y;
        G[x].pb(y);
        G[y].pb(x);
    }
    cal(1,0);
    dfs(1,0,dp[1]);
    for1(i,n) cout<<ans[i]<<endl;
    return 0;
}
{% endhighlight %}